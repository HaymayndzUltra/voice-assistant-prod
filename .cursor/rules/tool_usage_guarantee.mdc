---
alwaysApply: true
---

## TOOL USAGE GUARANTEE

For any phase execution or completion, the following sequence is MANDATORY:

1) Discovery/Verification before action:
```bash
python3 plan_next.py
python3 plain_hier.py <task_id>
```

2) Execute sub-step(s) as indicated by the plan preview:
```bash
python3 todo_manager.py exec <task_id> <SUB_INDEX>
```

3) Show current status to confirm progress:
```bash
python3 todo_manager.py show <task_id>
```

4) When a phase's sub-steps are all complete, finalize:
```bash
python3 todo_manager.py done <task_id ReplaceAll> <PHASE_INDEX>
```

5) Post-action verification:
```bash
python3 plan_next.py
```

These steps are required to avoid missed "done" transitions and to keep the plan in sync.## TOOL USAGE GUARANTEE

For any phase execution or completion, the following sequence is MANDATORY:

1) Discovery/Verification before action:
```bash
python3 plan_next.py
python3 plain_hier.py <task_id ReplaceAll>
```

2) Execute sub-step(s) as indicated by the plan preview:
```bash
python3 todo_manager.py exec <task_id ReplaceAll> <SUB_INDEX>
```

3) Show current status to confirm progress:
```bash
python3 todo_manager.py show <task_id ReplaceAll>
```

4) When a phase's sub-steps are all complete, finalize:
```bash
python3 todo_manager.py done <ReplaceAll> <PHASE_INDEX>
```

5) Post-action verification:
```bash
python3 plan_next.py
```

These steps are required to avoid missed "done" transitions and to keep the plan in sync.

### Placeholder substitution (exec)
- `python3 todo_manager.py exec` automatically substitutes placeholders in fenced commands before preview/execute:
  - `<task_id ReplaceAll>`, `<task_id Replace All>`, `<task_id>`, `<TASK_ID>`
  - `<PHASE_INDEX>`, `<phase_index>`
  - `<SUB_INDEX>`, `<sub_index>` (when selecting a specific command, e.g., K.N)
- This prevents shell errors from `<`/`>` characters and allows safe `--run` usage against plan commands.